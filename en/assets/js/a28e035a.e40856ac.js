"use strict";(self.webpackChunkdocusaurus_blog=self.webpackChunkdocusaurus_blog||[]).push([[5674],{6612:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>p,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var o=t(7462),a=(t(7294),t(3905)),i=t(828);const r={title:"Spring Boot - Cache",slug:"2018/02/05/spring-boot-cache",date:new Date("2018-02-05T20:04:01.000Z"),category:["spring"],tags:["spring","spring-boot","cache"]},p=void 0,l={permalink:"/en/2018/02/05/spring-boot-cache",source:"@site/blog/spring-boot-cache.md",title:"Spring Boot - Cache",description:"\uce90\uc2dc(cache, \ubb38\ud654\uc5b4: \uce90\uc26c, \uace0\uc18d\uc644\ucda9\uae30, \uace0\uc18d\uc644\ucda9\uae30\uc5b5\uae30)\ub294 \ucef4\ud4e8\ud130 \uacfc\ud559\uc5d0\uc11c \ub370\uc774\ud130\ub098 \uac12\uc744 \ubbf8\ub9ac \ubcf5\uc0ac\ud574 \ub193\ub294 \uc784\uc2dc \uc7a5\uc18c\ub97c \uac00\ub9ac\ud0a8\ub2e4.",date:"2018-02-05T20:04:01.000Z",formattedDate:"February 5, 2018",tags:[{label:"spring",permalink:"/en/tags/spring"},{label:"spring-boot",permalink:"/en/tags/spring-boot"},{label:"cache",permalink:"/en/tags/cache"}],readingTime:3.515,hasTruncateMarker:!0,authors:[],frontMatter:{title:"Spring Boot - Cache",slug:"2018/02/05/spring-boot-cache",date:"2018-02-05T20:04:01.000Z",category:["spring"],tags:["spring","spring-boot","cache"]},prevItem:{title:"Spring Boot - Interceptor",permalink:"/en/2018/02/06/spring-boot-interceptor"},nextItem:{title:"Spring Boot - Validation",permalink:"/en/2018/01/14/spring-boot-hibernate-validation"}},s={authorsImageUrls:[]},c=[{value:"\uc5b8\uc81c \uc0ac\uc6a9\ud558\uba74 \uc88b\uc744\uae4c?",id:"\uc5b8\uc81c-\uc0ac\uc6a9\ud558\uba74-\uc88b\uc744\uae4c",level:3},{value:"Dependency",id:"dependency",level:3},{value:"Config",id:"config",level:3},{value:"Component",id:"component",level:3},{value:"Test Code",id:"test-code",level:3},{value:"\uacb0\uacfc",id:"\uacb0\uacfc",level:4},{value:"\ucc38\uace0",id:"\ucc38\uace0",level:3}],g={toc:c};function u(e){let{components:n,...r}=e;return(0,a.kt)("wrapper",(0,o.Z)({},g,r,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("strong",{parentName:"p"},"\uce90\uc2dc(cache, \ubb38\ud654\uc5b4: \uce90\uc26c, \uace0\uc18d\uc644\ucda9\uae30, \uace0\uc18d\uc644\ucda9\uae30\uc5b5\uae30)"),"\ub294 \ucef4\ud4e8\ud130 \uacfc\ud559\uc5d0\uc11c \ub370\uc774\ud130\ub098 \uac12\uc744 \ubbf8\ub9ac \ubcf5\uc0ac\ud574 \ub193\ub294 \uc784\uc2dc \uc7a5\uc18c\ub97c \uac00\ub9ac\ud0a8\ub2e4.")),(0,a.kt)(i.G,{chart:"    graph LR\n        C1[Client] --\x3e App[Spring Boot Application]\n        C2[Client] --\x3e App[Spring Boot Application]\n        C3[Client] --\x3e App[Spring Boot Application]\n        C4[Client] --\x3e App[Spring Boot Application]\n        App[Spring Boot Application] --\x3e|Connection| D[DB]\n        App[Spring Boot Application] -.->|No Connection| D[DB]\n        App[Spring Boot Application] -.->|No Connection| D[DB]\n        App[Spring Boot Application] -.->|No Connection| D[DB]",mdxType:"Mermaid"}),(0,a.kt)("p",null,"Spring\uc758 \uc7a5\uc810 \uc911 PSA(Portable Service Abstractions)\ub77c\ub294 \uac83\uc774 \uc788\ub2e4. \uc774\ub294 \uc26c\uc6b4 \uc11c\ube44\uc2a4 \ucd94\uc0c1\ud654\ub77c\uace0 \ud558\ub294\ub370, \uac01\uac01\uc758 \uc678\ubd80 \uc11c\ube44\uc2a4\ub97c \uac04\ub2e8\ud55c \uc778\ud130\ud398\uc774\uc2a4\ub9cc\uc73c\ub85c \uc27d\uac8c \uc0ac\uc6a9\ud560 \uc218 \uc788\ub3c4\ub85d \uc124\uacc4\ub418\uc5b4\uc788\ub2e4. Cache\uc5d0\uc11c\ub294 Redis, Ehcache, ConcurrentMap \ub4f1\uc744 ",(0,a.kt)("inlineCode",{parentName:"p"},"CacheManager")," \uc778\ud130\ud398\uc774\uc2a4\ub85c \ucd94\uc0c1\ud654\ub418\uc5b4 \uc788\uace0, ",(0,a.kt)("inlineCode",{parentName:"p"},"CacheManager")," \uc778\ud130\ud398\uc774\uc2a4\ub97c \uc774\uc6a9\ud558\uc5ec \ub610 \ub2e4\ub978 cache \ub77c\uc774\ube0c\ub7ec\ub9ac\ub97c \uc0ac\uc6a9\ud560 \uc218\ub3c4 \uc788\ub2e4."),(0,a.kt)("h3",{id:"\uc5b8\uc81c-\uc0ac\uc6a9\ud558\uba74-\uc88b\uc744\uae4c"},"\uc5b8\uc81c \uc0ac\uc6a9\ud558\uba74 \uc88b\uc744\uae4c?"),(0,a.kt)("p",null,"\uc544\ub798 \uadf8\ub9bc\uacfc \uac19\uc740 \uba54\ub274\uac00 \ub2e8\uc801\uc778 \uc608\uc2dc\uac00 \ub420 \uc218 \uc788\ub2e4."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Alt example",src:t(87).Z,width:"636",height:"288"})),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\ubb34\uac70\uc6b4 \ube44\uc988\ub2c8\uc988 \ub85c\uc9c1\uc744 \uc218\ud589\ud560 \ub584"),(0,a.kt)("li",{parentName:"ul"},"\uc8fc\uae30\uc801\uc73c\ub85c\ub098 \uc5b8\uc81c\ub098 \ub3d9\uc77c\ud55c \ub370\uc774\ud130\ub97c \uac00\uc9c8 \ub584"),(0,a.kt)("li",{parentName:"ul"},"RDB\uc5d0 \ub300\ud55c \ubd80\ud558\ub97c \ubd84\uc0b0\ud558\uace0\uc790 \ud560 \ub54c")),(0,a.kt)("h3",{id:"dependency"},"Dependency"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-groovy"},"dependencies { \n    compile('org.springframework.boot:spring-boot-starter-cache')\n    testCompile('org.springframework.boot:spring-boot-starter-test') \n}\n")),(0,a.kt)("h3",{id:"config"},"Config"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"@EnableCaching"),"\uc744 \uba85\uc2dc\ud574\uc8fc\uba74 \ubc14\ub85c \uc0ac\uc6a9\ud560 \uc218 \uc788\uace0 \ucd94\uac00\uc801\uc778 \uc124\uc815\uc774 \uc5c6\ub2e4\uba74 ",(0,a.kt)("inlineCode",{parentName:"p"},"ConcurrentMap"),"\ub97c \uc0ac\uc6a9\ud558\uc5ec Caching\ud558\uac8c \ub41c\ub2e4. \ub610\ud55c ",(0,a.kt)("strong",{parentName:"p"},"Redis"),"\ub098 ",(0,a.kt)("strong",{parentName:"p"},"Ehcache")," \ub77c\uc774\ube0c\ub7ec\ub9ac\ub97c \ucd94\uac00\ud558\uba74 Spring Boot\uc758 ",(0,a.kt)("strong",{parentName:"p"},"Auto Detect")," \uae30\ub2a5\uc73c\ub85c \uc778\ud574 \ud574\ub2f9 \ub77c\uc774\ube0c\ub7ec\ub9ac\ub97c \uc790\ub3d9\uc801\uc73c\ub85c \uc774\uc6a9\ud558\uac8c \ub41c\ub2e4."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"@Configuration\n@EnableCaching\npublic CacheConfig {\n    \n}\n")),(0,a.kt)("h3",{id:"component"},"Component"),(0,a.kt)("p",null,"\ubb34\uac70\uc6b4 \ube44\uc988\ub2c8\uc2a4 \ub85c\uc9c1\uc774 \uc788\ub2e4\uace0 \uac00\uc815\ud558\uace0 \uc57d 3\ucd08\uc758 sleep\uc744 \uc8fc\ub3c4\ub85d \ud574\ubcf4\uc790.\n\uc544\ub798 \ucf54\ub4dc\ub97c \uac04\ub2e8\ud788 \uc124\uba85\ud558\uc790\uba74, book\uc774\ub77c\ub294 \uce90\uc2dc \uc601\uc5ed\uc5d0 isbn\uc744 \ud0a4\ub85c \uac16\ub294 \ub370\uc774\ud130\ub97c Caching \ud574\ub450\ub294 \uac83\uc774\ub2e4."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@Component\npublic class SimpleBookRepository implements BookRepository {\n\n    private static final Logger logger = LoggerFactory.getLogger(SimpleBookRepository.class);\n    \n    @Override\n    @Cacheable(value="book", key="#isbn")\n    public Book getByIsbn(String isbn) {\n        simulateSlowService();\n        return new Book(isbn, "Some book");\n    }\n\n    private void simulateSlowService() {\n        try {\n            long time = 3000L;\n            Thread.sleep(time);\n        } catch (InterruptedException e) {\n            throw new IllegalStateException(e);\n        }\n    }\n\n    @Override\n    @CacheEvict(value="book", key="#isbn")\n    public void refresh(String isbn) {\n        logger.info("cache clear => " + isbn);\n    }\n}\n')),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"@Cacheable"),": \uce90\uc2dc \uc0dd\uc131"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"value: \uce90\uc2dc \uc774\ub984"),(0,a.kt)("li",{parentName:"ul"},"key: \ud0a4")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"@CacheEvict"),": \uce90\uae30 \ucd08\uae30\ud654"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"value: \uce90\uc2dc \uc774\ub984"),(0,a.kt)("li",{parentName:"ul"},"key: \ud0a4")),(0,a.kt)("h3",{id:"test-code"},"Test Code"),(0,a.kt)("p",null,"\ub85c\uc9c1\uc5d0 \ub300\ud55c \uc18c\uc694\uc2dc\uac04\uc744 \uce21\uc815\ud574 \ubcf4\uc558\ub2e4."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@RunWith(SpringRunner.class)\n@SpringBootTest\npublic class SpringBootCacheApplicationTests {\n\n    @Autowired\n    private BookRepository repository;\n\n    private long startTime;\n    private long endTime;\n    \n    private static final Logger logger = LoggerFactory.getLogger(SpringBootCacheApplicationTests.class);\n    \n    @Before\n    public void onBefore() {\n        startTime = System.currentTimeMillis();\n    }\n    \n    @After\n    public void onAfter() {\n        endTime = System.currentTimeMillis();\n        logger.info("\uc18c\uc694\uc2dc\uac04: {}ms", endTime - startTime);\n    }\n    \n    @Test\n    public void test1() {\n        repository.getByIsbn("a");\n    }\n\n    @Test\n    public void test2() {\n        repository.getByIsbn("a");\n    }\n    \n\n    @Test\n    public void test3() {\n        repository.getByIsbn("b");\n    }\n    \n    @Test\n    public void test4() {\n        repository.getByIsbn("a");\n    }\n    \n    @Test\n    public void test5() {\n        repository.refresh("a");\n        repository.getByIsbn("a");\n    }\n}\n')),(0,a.kt)("h4",{id:"\uacb0\uacfc"},"\uacb0\uacfc"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"\uc18c\uc694\uc2dc\uac04: 3215ms\n\uc18c\uc694\uc2dc\uac04: 10ms\n\uc18c\uc694\uc2dc\uac04: 3006ms\n\uc18c\uc694\uc2dc\uac04: 8ms\ncache clear => a\n\uc18c\uc694\uc2dc\uac04: 3017ms\n")),(0,a.kt)("h3",{id:"\ucc38\uace0"},"\ucc38\uace0"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/heowc/SpringBootSample/tree/master/SpringBootCache"},"SpringBootSample / SpringBootCache")))}u.isMDXComponent=!0},87:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/example-87f7a6d9fe888a6b71b063f6ddd3dcbd.png"}}]);